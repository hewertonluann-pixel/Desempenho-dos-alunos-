<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relat√≥rio de Progresso Mensal</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{
    margin:0;
    font-family: Arial, Helvetica, sans-serif;
    background:#f2f2f2;
}

.top-bar{
    width:100%;
    background:#111;
    padding:10px;
    display:flex;
    justify-content:center;
    gap:15px;
}

.btn{
    padding:8px 15px;
    background:#444;
    color:#fff;
    border:none;
    border-radius:6px;
    cursor:pointer;
}

.page{
    width:210mm;
    min-height:297mm;
    margin:20px auto;
    background:white;
    padding:30px;
    box-shadow:0 0 10px rgba(0,0,0,0.2);
}

.header{
    display:flex;
    align-items:center;
    gap:20px;
    border-bottom:2px solid #ddd;
    padding-bottom:15px;
}

.header img{
    width:90px;
    height:90px;
    border-radius:50%;
    object-fit:cover;
}

h1{
    margin:0;
    font-size:24px;
}

.mes{
    margin-top:5px;
    font-weight:bold;
    color:#666;
}

.cards{
    display:flex;
    justify-content:space-between;
    margin-top:30px;
}

.card{
    width:30%;
    background:#fafafa;
    padding:15px;
    border-radius:10px;
    text-align:center;
    border:1px solid #ddd;
}

.card h3{
    margin-bottom:10px;
}

.valor{
    font-size:26px;
    font-weight:bold;
    margin:5px 0;
}

.status{
    font-weight:bold;
    margin-top:5px;
}

.evoluiu{ color:green; }
.estavel{ color:#888; }
.regrediu{ color:red; }

.meta{
    font-size:14px;
    margin-top:5px;
    color:#555;
}

.section{
    margin-top:35px;
}

.section h2{
    border-bottom:1px solid #ddd;
    padding-bottom:5px;
}

.ensaio{
    display:flex;
    justify-content:space-between;
    padding:6px 0;
    border-bottom:1px solid #eee;
}

.presente{
    color:green;
}

.falta{
    color:red;
}

@media print{
    body{
        background:white;
    }
    .top-bar{
        display:none;
    }
    .page{
        box-shadow:none;
        margin:0;
    }
}
</style>
</head>

<body>

<div class="top-bar">
    <button class="btn" onclick="window.print()">üñ®Ô∏è Imprimir / PDF</button>
    <button class="btn" id="btnJPG">üñºÔ∏è Exportar JPG</button>
</div>

<div class="page" id="pagina-relatorio">

    <div class="header">
        <img src="https://i.pravatar.cc/300" alt="Foto do aluno">
        <div>
            <h1>Relat√≥rio de Progresso Mensal</h1>
            <div><strong>Jo√£o Silva</strong> - Violino</div>
            <div class="mes">M√™s: Junho 2026</div>
        </div>
    </div>

    <div class="cards">

        <div class="card" id="cardPresenca"></div>
        <div class="card" id="cardLeitura"></div>
        <div class="card" id="cardMetodo"></div>

    </div>

    <div class="section">
        <h2>An√°lise do Desempenho</h2>
        <p id="analiseTexto"></p>
    </div>

    <div class="section">
        <h2>Presen√ßa nos Ensaios</h2>
        <div id="listaEnsaios"></div>
    </div>

</div>

<script>
const dados = {
    presenca: { anterior:75, atual:85, meta:95 },
    leitura: { anterior:60, atual:60, meta:80 },
    metodo: { anterior:70, atual:65, meta:85 },
    ensaios:[
        {data:"03/06", presente:true},
        {data:"10/06", presente:true},
        {data:"17/06", presente:false},
        {data:"24/06", presente:true},
    ]
};

function calcularStatus(anterior, atual){
    if(atual > anterior) return {texto:"Evoluiu", classe:"evoluiu"};
    if(atual < anterior) return {texto:"Regrediu", classe:"regrediu"};
    return {texto:"Est√°vel", classe:"estavel"};
}

function gerarCard(id, titulo, info){
    const status = calcularStatus(info.anterior, info.atual);
    document.getElementById(id).innerHTML = `
        <h3>${titulo}</h3>
        <div>M√™s anterior: ${info.anterior}%</div>
        <div class="valor">${info.atual}%</div>
        <div class="status ${status.classe}">${status.texto}</div>
        <div class="meta">Meta pr√≥xima: ${info.meta}%</div>
    `;
}

gerarCard("cardPresenca","Presen√ßa",dados.presenca);
gerarCard("cardLeitura","Leitura",dados.leitura);
gerarCard("cardMetodo","M√©todo",dados.metodo);

function gerarAnalise(){
    let texto = "";

    ["presenca","leitura","metodo"].forEach(tipo=>{
        const s = calcularStatus(dados[tipo].anterior, dados[tipo].atual).texto;
        if(s==="Evoluiu"){
            texto += `Houve evolu√ß√£o em ${tipo}. Continue mantendo a disciplina e dedica√ß√£o.\n\n`;
        }
        if(s==="Est√°vel"){
            texto += `${tipo} permaneceu est√°vel. √â importante buscar novos desafios.\n\n`;
        }
        if(s==="Regrediu"){
            texto += `Foi identificada regress√£o em ${tipo}. √â necess√°rio refor√ßar treinos.\n\n`;
        }
    });

    document.getElementById("analiseTexto").innerText = texto;
}

gerarAnalise();

function gerarEnsaios(){
    const lista = document.getElementById("listaEnsaios");
    dados.ensaios.forEach(e=>{
        lista.innerHTML += `
        <div class="ensaio">
            <div>${e.data}</div>
            <div class="${e.presente?'presente':'falta'}">
                ${e.presente?'Presente':'Falta'}
            </div>
        </div>
        `;
    });
}

gerarEnsaios();

document.getElementById("btnJPG").addEventListener("click", async ()=>{
    const elemento = document.getElementById("pagina-relatorio");
    const canvas = await html2canvas(elemento,{scale:3});
    const link = document.createElement("a");
    link.download = "relatorio.jpg";
    link.href = canvas.toDataURL("image/jpeg",1.0);
    link.click();
});
</script>

</body>
</html>
